---
title: "R Notebook"
output: html_notebook
---

```{r}
library(tidyverse)
library(janitor)

p19t14 <- read_csv("~/Desktop/Stat380/CopyOfp19t14.csv")
p19t14 <- p19t14%>%
  select(-'Bureau of Justice Statistics')

p19t14_flip1 <- as.data.frame(t(p19t14))

```
```{r}
#library(readr)
#CopyOfp19t14 <- read_csv("~/Desktop/Stat380/CopyOfp19t14.csv")
#View(CopyOfp19t14)
```

```{r}
p19t14_flip1 <- p19t14_flip1 %>%
  select(-c("V1","V2", "V3", "V4", "V5", "V6", "V7", "V8", "V9", "V33", "V34", "V35", "V36", "V37", "V38", "V39", "V40"))
p19t14_flip1
```

```{r}
names(p19t14_flip1) <- as.matrix(p19t14_flip1[1, ])
p19t14_flip1 <- p19t14_flip1[-1, ]
p19t14_flip1[] <- lapply(p19t14_flip1, function(x) type.convert(as.character(x)))
View(p19t14_flip1)
```

```{r}
colnames(p19t14_flip1)[1] <- 'Characteristic'
colnames(p19t14_flip1)[3] <- 'Violent Crime Totals' #Murder, Negligent manslaughter, Rapse/sexual assualt, robbery, aggravated/simple assault, other
colnames(p19t14_flip1)[9] <- 'Other Violent Crimes'
colnames(p19t14_flip1)[10] <- 'Property Crime Totals' #Burglary, Larcenty/theft, Motor-vehicle theft, fraud, other
colnames(p19t14_flip1)[15] <- 'Other Property Crimes'
colnames(p19t14_flip1)[16] <- 'Drug Crime Totals' #Possession, other
colnames(p19t14_flip1)[18] <- 'Other Drug Crimes'
colnames(p19t14_flip1)[19] <- 'Public Order Crime Totals' #weapons, dui/dwi, other
colnames(p19t14_flip1)[22] <- 'Other Public Order Crimes'
colnames(p19t14_flip1)[23] <- 'Other/Unspecified Crime Totals'
```


```{r}
p19t14_flip1 %>%
  select(Characteristic, Total, `Violent Crime Totals`, `Property Crime Totals`,`Drug Crime Totals`, `Public Order Crime Totals`, `Other/Unspecified Crime Totals` )
```

```{r}
table1014_idea <- map_df(p19t14_flip1, ~gsub(",","", .x))
table1014_idea2 <- as.data.frame(sapply(table1014_idea, as.numeric ))
#table1014_idea2
characteristic <- c("All prisoners", "Male", "Female", "White/b", "Black/b", "Hispanic")
table1014_idea2$Characteristic <- characteristic
table1014_idea2
```

#unsupervised learning...clustering
```{r}
library(tidyverse)
library(cluster)
library(factoextra)
```

```{r}
fviz_nbclust(table1014_idea2, hcut, hc_method = "complete", hc_metric = "euclidean", method = "wss")

```


